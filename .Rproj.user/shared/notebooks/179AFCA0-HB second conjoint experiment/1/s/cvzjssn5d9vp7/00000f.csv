"0","calculate_ci <- function(data, n_resample = 10000) {"
"0","  ci_results <- list()"
"0",""
"0","  for (col in names(data)) {"
"0","    # Initialize vector for resampled statistics"
"0","    statistics_resampled <- numeric(n_resample)"
"0",""
"0","    # Resampling loop"
"0","    for (i in 1:n_resample) {"
"0","      # Resample the data and calculate the median"
"0","      resampled_data <- sample(data[[col]], size = nrow(data), replace = TRUE)"
"0","      statistics_resampled[i] <- median(resampled_data)"
"0","    }"
"0",""
"0","    # Calculate the median of the original data"
"0","    original_median <- median(data[[col]])"
"0",""
"0","    # Calculate the 95% confidence interval"
"0","    ci_lower <- quantile(statistics_resampled, probs = 0.025)"
"0","    ci_upper <- quantile(statistics_resampled, probs = 0.975)"
"0",""
"0","    # Store the results (including the original median)"
"0","    ci_results[[col]] <- c(Median = original_median, CI_Lower = ci_lower, CI_Upper = ci_upper)"
"0","  }"
"0",""
"0","  return(ci_results)"
"0","}"
"0",""

"0"," # Function to calculate weights"
"0","calculate_weights <- function(data, column, dist) {"
"0","  factor_column <- factor(data[[column]], levels = names(dist))"
"0","  proportions <- table(factor_column) / nrow(data)"
"0","  weights <- sapply(levels(factor_column), function(x) dist[x] / proportions[x])"
"0","  return(weights[as.character(factor_column)])"
"0","}"
"0",""
"0","# Apply weights to dfcj"
"0","dfcj$gender_weight <- calculate_weights(dfcj, ""gender"", gender_dist)"
"0","dfcj$age_weight <- calculate_weights(dfcj, ""age"", age_dist)"
"0","dfcj$income_weight <- calculate_weights(dfcj, ""income"", income_dist)"
"0","dfcj$education_weight <- calculate_weights(dfcj, ""education"", education_dist)"
"0",""
"0","# Check the first few entries"
"0","head(dfcj)"

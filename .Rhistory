estimate = "amce",
by = ~religiosity)
diff_amcerel2nr <- cj(dfcj2nr, choice_indicator ~ expected_pension + gender_equality + living_wage + salary_equality + labor_rights + environmental_impact + faith_morality + firearms, id = ~survey_id, estimate = "amce_diff",
by = ~religiosity)
plot(diff_amcerel2nr, vline=0) + ggplot2::facet_wrap(~BY, ncol = 3L) +
theme_classic() +
theme(text = element_text(family = "CMU Serif"))
dfcjnr = dfcj %>%
filter(republican==0)
amcesrelnr <- cj(dfcjnr, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~survey_id,
estimate = "amce",
by = ~religiosity)
diff_amcerelnr <- cj(dfcjnr, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~survey_id, estimate = "amce_diff",
by = ~religiosity)
plot(diff_amcerelnr, vline=0) + ggplot2::facet_wrap(~BY, ncol = 3L) +
theme_classic() +
theme(text = element_text(family = "CMU Serif"))
#Only republicans
dfcjr = dfcj %>%
filter(republican==1)
amcesrelr <- cj(dfcjr, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~survey_id,
estimate = "amce",
by = ~religiosity)
diff_amcerelr <- cj(dfcjr, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~survey_id, estimate = "amce_diff",
by = ~religiosity)
plot(diff_amcerelr, vline=0) + ggplot2::facet_wrap(~BY, ncol = 3L) +
theme_classic() +
theme(text = element_text(family = "CMU Serif"))
dfcj2r = dfcj2 %>%
filter(republican==1)
amcesrel2r <- cj(dfcj2r, choice_indicator ~ expected_pension + gender_equality + living_wage + salary_equality + labor_rights + environmental_impact + faith_morality + firearms,
id = ~survey_id,
estimate = "amce",
by = ~religiosity)
diff_amcerel2r <- cj(dfcj2r, choice_indicator ~ expected_pension + gender_equality + living_wage + salary_equality + labor_rights + environmental_impact + faith_morality + firearms, id = ~survey_id, estimate = "amce_diff",
by = ~religiosity)
plot(diff_amcerel2r, vline=0) + ggplot2::facet_wrap(~BY, ncol = 3L) +
theme_classic() +
theme(text = element_text(family = "CMU Serif"))
View(diff_amcerel)
options(scipen=999)
options(digits = 3)
library(readr)
#setwd("/Users/ovd/Documents/GitHub/esg_pensions")
raw.dfcj <- read_csv("rds_prod.experiment.420656.stacked(18).csv")
table(raw.dfcj$Q10_AGE_WRITE_IN)
library(cregg)
library(janitor)
library(tidyverse)
dfcj = raw.dfcj %>%
clean_names()
#'*Check whether it makes sense to filter speeders (if any).*
median_complet_t = median(dfcj$respondent_length_of_interview_seconds)
# calculate median completion time in secs
dfcj$income_num = readr::parse_number(dfcj$q17_annual_income)
hist(dfcj$respondent_length_of_interview_seconds)
median(dfcj$respondent_length_of_interview_seconds)
434/60
dfcj2 = dfcj %>%
filter(respondent_length_of_interview_seconds >= 0.5 * median_complet_t,
respondent_length_of_interview_seconds <= 2 * median_complet_t) %>%
filter(!is.na(income_num)) %>%
filter(income_num > 15000)
nrow(dfcj2)/24 #1,617 responses!
dffilt = dfcj %>%
filter(income_num < 15000)
nrow(dffilt)/24
dfcj = dfcj %>%
mutate(include = ifelse(respondent_length_of_interview_seconds >= 0.5 * median_complet_t & respondent_length_of_interview_seconds <= 2 * median_complet_t & income_num > 15000 & !is.na(income_num), 1, 0))
mean(dfcj$include)
dfcj = dfcj %>%
mutate(CONJOINTLY_ACTION = ifelse(include ==1, "INCLUDE_IN_ANALYSIS", "EXCLUDE_FROM_ANALYSIS"))
table(dfcj$CONJOINTLY_ACTION)
dfconjointly = dfcj %>%
select(survey_id, CONJOINTLY_ACTION)
#revert
#dfconjointly$CONJOINTLY_ACTION = "INCLUDE_IN_ANALYSIS"
write_csv(dfconjointly, "dfconjointly.csv")
# filter responded too quickly or slowly
#Transform variables to factors
dfcj = dfcj %>%
mutate(expected_pension = factor(expected_pension),
firearms = factor(invests_in_firearms,
levels = c("Invests in firearms", "Does not invest in firearms")),
fossil_fuels =  factor(invests_in_fossil_fuels,
levels = c("Invests in fossil fuels", "Does not invest in fossil fuels")),
may_employ_children = factor(invests_in_firms_that_may_employ_children,
levels = c("Invests in firms that may employ children", "Invests in firms that ensure no children are employed")),
racial_diversity = factor(advocates_for_racial_diversity_in_management,
levels = c("Does not advocate for racial diversity in management",
"Advocates for racial diversity in management")),
gender_equal_pay = factor(advocates_for_equal_pay_for_men_and_women,
levels = c("Does not advocate for equal pay for men and women",
"Advocates for equal pay for men and women")),
choice_indicator = as.numeric(choice_indicator),
choice = as.factor(choice_indicator),
prior = factor(ifelse(q9_taking_into_account_esg_factors_o1_yes ==1, "pro-esg", "anti-esg")),
republican = factor(ifelse(q11_party_id_o1_republican==1 |
q12_party_leanings_o1_republican ==1, 1,0)),
florida = factor(ifelse(q15_state_us_o1_florida==1, 1,0)),
california = factor(ifelse(q15_state_us_o2_california==1,1,0)),
age = 2023 - (q10_age_write_in))
dfcj %>%
select(invests_in_firms_that_may_employ_children, choice_indicator) %>%
table()
dffl = dfcj %>%
filter(florida==1)
dfcl = dfcj %>%
filter(california==1)
# Work with weights with a mean of 1
total = nrow(dfcj)
florida.p = nrow(dffl)/total
cali.p = nrow(dfcl)/total
us.p = (total- nrow(dffl) - nrow(dfcl))/total
florida.weight = (6.6/florida.p)/100
cali.weight = (12/cali.p)/100
us.weight = (81.4/us.p)/100
#Check gender and age
flfem = dffl %>%
filter(q13_gender_o2_female==1)
flfem.n = nrow(flfem)/24
flmale = dffl %>%
filter(q13_gender_o1_male==1)
flmale.n = nrow(flmale)/24
#California
cafem = dfcl %>%
filter(q13_gender_o2_female==1)
cafem.n= nrow(cafem)/24
camale = dfcl %>%
filter(q13_gender_o1_male==1)
camale.n =nrow(camale)/24
#U.S.
total_no_filter = nrow(dfcj)/24
total_filtered =nrow(dfcj2)/24
usfem = dfcj %>%
filter(q15_state_us_o3_other==1,
q13_gender_o2_female==1)
usmale = dfcj %>%
filter(q15_state_us_o3_other==1,
q13_gender_o1_male==1)
usfem.n = nrow(usfem)/24
usmale.n = nrow(usmale)/24
dfcj = dfcj %>%
mutate(state.weight = case_when(florida==1 ~ florida.weight,
california==1 ~ cali.weight,
florida == 0 & california == 0 ~us.weight))
#mean(dfcjw$weight) # Looks good
# weight = dfcjw$weights
mmusw <- cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~ survey_id,
estimate = "mm", weights = ~ state.weight)
amceusw <- cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~ survey_id,
estimate = "amce", weights = ~ state.weight)
plot(mmusw, vline = 0.5) +
ggtitle("U.S. Weighted Sample")
plot(amceusw, vline = 0) +
theme_minimal()
summary(amceusw)
ggsave("amceusw.pdf", width = 10, height = 5)
dfcj=dfcj %>%
mutate(income = case_when(income_num <=24999 ~ "15,000 to 24,999",
income_num >=25000 & income_num <=34999 ~ "25,000 to 34,999",
income_num >= 35000 & income_num <=49999 ~  "35,000 to 49,999",
income_num >= 50000 & income_num <=74999 ~ "50,000 to 74,999",
income_num >= 75000 & income_num <=99999 ~ "75,000 to 99,999",
income_num >= 100000 ~ "100,000 or more"))
table(dfcj$income)
dfcj = dfcj %>%
mutate(gender = case_when(q13_gender_o1_male == 1 ~ "male",
q13_gender_o2_female == 1 ~ "female",
q13_gender_o3_other == 1 ~ "other"),
education = case_when(q16_education_o1_some_high_school == 1 ~ "less than hs",
q16_education_o2_high_school ==1 ~ "hs",
q16_education_o3_some_college ==1 ~ "hs",
q16_education_o4_college_degree== 1 ~ "college",
q16_education_o5_graduate_degree == 1 ~ "grad school"),
religiosity =case_when(q18_frequency_o1_0 == 1 ~ "no/low",
q18_frequency_o2_1 == 1 ~ "no/low",
q18_frequency_o3_2 == 1 ~ "mid",
q18_frequency_o4_3 == 1 ~ "mid",
q18_frequency_o5_4 == 1 ~ "high",
q18_frequency_o6_5 == 1 ~ "high",
q18_frequency_o7_6 == 1 ~ "high",
q18_frequency_o8_7 == 1 ~ "high"),
prior = as.factor(ifelse(q9_taking_into_account_esg_factors_o1_yes == 1, 1, 0)),
ethnicity = case_when(q14_ethnicity_o1_white == 1 ~ "white",
q14_ethnicity_o2_asian ==1 ~ "asian",
q14_ethnicity_o3_hispanic == 1 ~ "hispanic",
q14_ethnicity_o4_african_american == 1 ~ "african american",
q14_ethnicity_o5_native_american ==1 ~ "native american",
q14_ethnicity_o6_other ==1 ~ "other"))
mean(dfcj$age, na.rm = T) # There are NAs
dfcj =dfcj %>%
select(respondent_id,
survey_id,
choice_set,
label,
choice_indicator,
expected_pension,
firearms,
fossil_fuels,
may_employ_children,
racial_diversity,
gender_equal_pay,
respondent_length_of_interview_seconds,
prior,
income,
gender,
education,
age,
republican,
state.weight,
florida,
california,
religiosity)
dfcj = na.omit(dfcj)
dfcj = dfcj %>%
mutate(age.cat = case_when(age > 17 & age <=24 ~ "18-24",
age >= 25 & age <=39 ~ "25-39",
age >= 40 & age <=55 ~ "40-55",
age >=56 ~ "56+"))
dfcj$age.cat <- factor(dfcj$age.cat, levels = c("18-24", "25-39", "40-55", "56+"))
names(dfcj)
# Assuming your data frame 'df' has 'gender', 'age', 'income', and 'education' columns
# Define the distributions
gender_dist <- c("male" = 44.5, "female" = 45.5, "other" = 10)
age_dist <- c("18-24" = 0.12, "25-39" = 0.27, "40-55" = 0.26, "56+" = 0.35)
income_dist <- c("under 15,000" = 8.3, "15,000 to 24,999" = 7.4, "25,000 to 34,999" = 7.6,
"35,000 to 49,999" = 10.6, "50,000 to 74,999" = 16.2, "75,000 to 99,999" = 12.3,
"100,000 or more" = 37.5)
education_dist <- c("less than hs" = 9, "hs" = 28, "some college" = 15,
"college" = 33, "grad school" = 14)
# Normalize distributions to sum to 1 (100%)
gender_dist <- gender_dist / sum(gender_dist)
age_dist <- age_dist / sum(age_dist)
income_dist <- income_dist / sum(income_dist)
education_dist <- education_dist / sum(education_dist)
median_complet_t = median(dfcj$respondent_length_of_interview_seconds)
dfcj = dfcj %>%
filter(respondent_length_of_interview_seconds >= 0.5 * median_complet_t & respondent_length_of_interview_seconds <= 2 * median_complet_t)
dfcj$gender <- factor(dfcj$gender, levels = c("male", "female", "other"))
dfcj$age.cat <- factor(dfcj$age.cat, levels = c("18-24", "25-39", "40-55", "56+"))
dfcj$income <- factor(dfcj$income, levels = c("15,000 to 24,999", "25,000 to 34,999",
"35,000 to 49,999", "50,000 to 74,999", "75,000 to 99,999",
"100,000 or more"))
dfcj$education <- factor(dfcj$education, levels = c("less than hs", "hs", "some college",
"college", "grad school"))
# Checking the levels of the income variable
levels(dfcj$income)
table(dfcj$income)
# Function to calculate weights for each row
calculate_weight <- function(data, column, dist) {
factor_column <- factor(data[[column]], levels = names(dist))
proportions <- table(factor_column) / nrow(data)
# Handle NA values
factor_column[is.na(factor_column)] <- "NA"
proportions["NA"] <- 1
weights <- vector("numeric", length = nrow(data))
for (i in 1:nrow(data)) {
cat <- as.character(factor_column[i])
weights[i] <- dist[cat] / proportions[cat]
}
return(weights)
}
# Applying the function to each column
dfcj$gender_weight <- calculate_weight(dfcj, "gender", gender_dist)
dfcj$age_weight <- calculate_weight(dfcj, "age.cat", age_dist)
dfcj$income_weight <- calculate_weight(dfcj, "income", income_dist)
dfcj$education_weight <- calculate_weight(dfcj, "education", education_dist)
# View the first few entries
sum(is.na(dfcj$age_weight))
dfcj$weights = dfcj$gender_weight * dfcj$age_weight * dfcj$income_weight * dfcj$education_weight * dfcj$state.weight
summary(dfcj$weights)
names(dfcj)
library(ggthemes)
library(ggsci)
amce1 = cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~ survey_id,
estimate = "amce", weights = ~ weights)
amce1plot = plot(amce1, vline =0, feature_headers = F) +
theme(text = element_text(family = "CMU Serif")) +
scale_color_jco()
amce1plot
ggsave(amce1plot, path = NULL,
filename = "amcecj1jmain.png",
device = "png",
type = "cairo",
dpi = "retina",
width = 12,
height = 6)
amce1shorter = amce1 %>%
filter(!str_detect(feature, "pension"))
#Trying to produce nicer plots
amce1shorter = plot(amce1shorter, vline =0, feature_headers = F) +
theme(text = element_text(family = "CMU Serif")) +
scale_color_jco() +
ggplot2::facet_wrap(~feature, ncol = 1L,
scales = "free_y", strip.position = "top")
amce1shorter +
ggplot2::scale_fill_manual(labels=c("firearms", "fossil fuels", "child labor", "racial diversity", "gender pay parity"))
ggsave(amce1shorter, path = NULL,
filename = "amcecj1jmainb.png",
device = "png",
type = "cairo",
dpi = "retina", height = 4)
mmusw_by_r <- cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~ survey_id,
estimate = "mm", weights = ~ weights,
by = ~republican)
amceusw_by_r <- cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~ survey_id,
estimate = "amce", weights = ~ weights,
by = ~republican)
plot(mmusw_by_r, group = "republican", vline = 0.5) +
scale_colour_manual(na.translate = F, values = c("royalblue", "red3")) +
ggtitle("U.S. Weighted Sample")
amce_byr_plot = plot(amceusw_by_r, group = "republican", vline = 0, feature_headers = F) +
scale_colour_manual(na.translate = F, values = c("royalblue", "red3"), labels=c('no', 'yes')) +
theme(text = element_text(family = "CMU Serif"))
ggsave(amce_byr_plot, path = NULL,
filename = "amcecj1j_byr.png",
device = "png",
type = "cairo",
dpi = "retina")
amce_byr_plot
amce_byr_shorter = amceusw_by_r %>%
filter(!str_detect(feature, "pension"))
#Trying to produce nicer plots
amce_byr_shorter_plot = plot(amce_byr_shorter, vline =0, feature_headers = F) +
scale_colour_manual(na.translate = F, values = c("royalblue", "red3"), labels=c('no', 'yes')) +
theme(text = element_text(family = "CMU Serif")) +
ggplot2::facet_wrap(~feature, ncol = 1L,
scales = "free_y", strip.position = "top")
ggsave(amce_byr_shorter_plot, path = NULL,
filename = "amce_byr_shorter.png",
device = "png",
type = "cairo",
dpi = "retina", height = 5)
amce_byr_shorter_plot
diff_amces <- cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~ survey_id,
estimate = "amce_diff", weights = ~ weights,
by = ~republican)
plot(diff_amces)
#plot(rbind(amceusw_by_w, diff_amces)) + ggplot2::facet_wrap(~BY, ncol = 3L) + theme_linedraw() + scale_color_jco()
# Shorter plot easier to understand
amceusw_fl <- cj(dfcj, choice_indicator ~ firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~ survey_id,
estimate = "amce", #weights = ~ weights,
by = ~florida)
plot(amceusw_fl, group = "florida",vline=0) +
scale_colour_manual(na.translate = F, values = c("royalblue", "orange3"))
table(dfcj$republican, dfcj$prior)
mmusw_byprior <- cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~ survey_id,
estimate = "mm", weights = ~ weights,
by = ~prior)
amceusw_byprior <- cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~ survey_id,
estimate = "amce", weights = ~ weights,
by = ~prior)
plot(amceusw_byprior, group = "prior", vline = 0, feature_headers = F) +
scale_colour_manual(na.translate = F, values = c("#F8867D", "#00BFC4"), labels=c('anti-ESG', 'pro-ESG')) +
theme(text = element_text(family = "CMU Serif"))
ggsave("amceprior.png",
device = "png",
type = "cairo",
dpi = "retina")
summary(amceusw_byprior)
# +
#  # scale_colour_manual(na.translate = F, values = c("navy", "turquoise")) +
#   ggtitle("U.S. Weighted Sample")
#Check age differences
dfcj = dfcj %>%
mutate(fiftysix = factor(ifelse(age.cat == "56+", 1,0)))
amceusw_byage <- cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~ survey_id,
estimate = "amce", weights = ~ weights,
by = ~fiftysix)
plot(amceusw_byage, group = "fiftysix", vline = 0, feature_headers = F)
# +
#   scale_colour_manual(na.translate = F, values = c("#F8867D", "#00BFC4"), labels=c('anti-ESG', 'pro-ESG')) +
#   theme(text = element_text(family = "CMU Serif"))
df56 = dfcj %>%
select(survey_id, fiftysix)
write.csv(df56, "df56.csv")
# Florida
amce_byfl <- cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~ survey_id,
estimate = "amce",
weights = ~weights,
by = ~florida)
plot(amce_byfl, group = "florida", vline = 0) +
scale_colour_manual(na.translate = F, values = c("royalblue", "red3"))
ggsave("amcefl.pdf", width = 10, height = 5)
# calculate conditional MMs
dfcj = dfcj %>%
mutate(religiosity = factor(religiosity,
levels = c("no/low", "mid", "high")))
dfcj$religiosity <- fct_relevel(dfcj$religiosity, "no/low", "mid","high")
amcesrel <- cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~survey_id,
estimate = "amce",
by = ~religiosity)
diff_amcerel <- cj(dfcj, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~survey_id, estimate = "amce_diff",
by = ~religiosity)
plot(diff_amcerel, vline=0) + ggplot2::facet_wrap(~BY, ncol = 3L) +
theme_classic() +
theme(text = element_text(family = "CMU Serif"))
#ggsave("amcerel.pdf", width = 10, height = 5)
#plot(rbind(mms, diff_mms)) + ggplot2::facet_wrap(~BY, ncol = 3L) #weird
dfcjnr = dfcj %>%
filter(republican==0)
amcesrelnr <- cj(dfcjnr, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~survey_id,
estimate = "amce",
by = ~religiosity)
diff_amcerelnr <- cj(dfcjnr, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~survey_id, estimate = "amce_diff",
by = ~religiosity)
plot(diff_amcerelnr, vline=0) + ggplot2::facet_wrap(~BY, ncol = 3L) +
theme_classic() +
theme(text = element_text(family = "CMU Serif"))
#Only republicans
dfcjr = dfcj %>%
filter(republican==1)
amcesrelr <- cj(dfcjr, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~survey_id,
estimate = "amce",
by = ~religiosity)
diff_amcerelr <- cj(dfcjr, choice_indicator ~ expected_pension + firearms + fossil_fuels + may_employ_children + racial_diversity + gender_equal_pay, id = ~survey_id, estimate = "amce_diff",
by = ~religiosity)
plot(diff_amcerelr, vline=0) + ggplot2::facet_wrap(~BY, ncol = 3L) +
theme_classic() +
theme(text = element_text(family = "CMU Serif"))
View(diff_amcerelnr)
View(diff_amcerel2)
View(diff_amcerel)
View(diff_amcerel2r)
options(scipen=999)
library(readr)
library(janitor)
library(extrafont)
library(Cairo)
library(tidyverse)
df <- read_csv("Search+Prolific+Sept28_September+28,+2023_15.47.csv")
View(df)
source('Theme_Publication.R')
library(readr)
df1 <- read_csv("~/Documents/Cookies/cookies.csv")
View(df1)
#Remove vars
library(tidyverse)
library(janitor)
df1 <- df1 %>%
clean_names() %>%
select(-(recorded_date:user_language)) %>%
select(-(q22_last_click:q22_click_count)) %>%
select(-(q23_last_click:q23_click_count)) %>%
select(-random_id, -(start_date:progress))
#Remove first two rows
df1 <- df1 %>%
slice(-c(1,2))
# Gen new vars
# Manipulation var
df <- df1 %>%
mutate(highlighted = (ifelse(fl_10_do == "Block5", 1, 0)),
duration_in_seconds = as.numeric(duration_in_seconds))
# First click
dfclick <- df %>%
mutate(first_click = as.numeric(ifelse(!is.na(df$q22_first_click),
df$q22_first_click, df$q23_first_click)))
View(df)
levels(df$q6)
table(df$q6)
df = df %>%
mutate(want.per.ads = case_when(q6 == "Definitely not" ~ 1,
q6 == "Probably not" ~ 2,
q6 == "Might or might not" ~3,
q6 == "Probably yes" ~ 4,
q6 == "Definitely yes" ~ 5),
gender = q12)
df = df %>%
mutate(want.per.ads = case_when(q6 == "Definitely not" ~ 1,
q6 == "Probably not" ~ 2,
q6 == "Might or might not" ~3,
q6 == "Probably yes" ~ 4,
q6 == "Definitely yes" ~ 5),
gender = factor(q12),
age = q11,
educ = factor(q13))
lm(data = df, formula = want.per.ads ~ gender +age+educ)
lm1 = lm(data = df, formula = want.per.ads ~ gender +age+educ)
summary(lm1)
# q6 is whether people would like to get personalized ads
# q7 attitudes towards personalized ads (1 = definitely yes)
table(df$q6)
df = df %>%
mutate(want.per.ads = case_when(q6 == "Definitely not" ~ 1,
q6 == "Probably not" ~ 2,
q6 == "Might or might not" ~3,
q6 == "Probably yes" ~ 4,
q6 == "Definitely yes" ~ 5),
gender = factor(q12),
age = as.numeric(q11),
educ = factor(q13))
lm1 = lm(data = df, formula = want.per.ads ~ gender +age+educ)
summary(lm1)
df$q7
table(df$q7)
df = df %>%
mutate(want.per.ads = case_when(q6 == "Definitely not" ~ 1,
q6 == "Probably not" ~ 2,
q6 == "Might or might not" ~3,
q6 == "Probably yes" ~ 4,
q6 == "Definitely yes" ~ 5),
gender = factor(q12),
age = as.numeric(q11),
educ = factor(q13),
like.per.ads = case_when(q7=="Dislike a great deal"~1,
q7=="Dislike somewhat"~2,
q7=="Neither like nor dislike"~3,
q7=="Like somewhat"~4,
q7=="Like a great deal"~5))
lm2 = lm(data = df, formula = like.per.ads ~ gender +age+educ)
summary(lm2)
